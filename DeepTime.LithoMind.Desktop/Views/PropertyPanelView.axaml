<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:DeepTime.LithoMind.Desktop.ViewModels.Pages"
             x:Class="DeepTime.LithoMind.Desktop.Views.PropertyPanelView"
             x:DataType="vm:PropertyPanelViewModel">
    
    <Grid RowDefinitions="Auto,*,Auto">
        <!-- é¡¶éƒ¨æ ‡é¢˜æ  -->
        <Border Grid.Row="0" Background="#2C3E50" Padding="8">
            <Grid ColumnDefinitions="*,Auto,Auto">
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="ðŸ“‹" FontSize="16" VerticalAlignment="Center"/>
                    <TextBlock Text="å±žæ€§çª—å£" FontSize="14" Foreground="White" FontWeight="Bold" VerticalAlignment="Center"/>
                </StackPanel>
                <!-- åˆ·æ–°æŒ‰é’® -->
                <Button Grid.Column="1" 
                        Content="ðŸ”„" 
                        ToolTip.Tip="åˆ·æ–°æ•°æ®"
                        Command="{Binding RefreshDataCommand}"
                        Background="Transparent"
                        Foreground="White"
                        BorderThickness="0"
                        Padding="5"
                        Cursor="Hand"/>
                <!-- æ¸…é™¤æŒ‰é’® -->
                <Button Grid.Column="2" 
                        Content="ðŸ—‘ï¸" 
                        ToolTip.Tip="æ¸…é™¤æ•°æ®"
                        Command="{Binding ClearDataCommand}"
                        Background="Transparent"
                        Foreground="White"
                        BorderThickness="0"
                        Padding="5"
                        Cursor="Hand"/>
            </Grid>
        </Border>
        
        <!-- ä¸»å†…å®¹åŒº -->
        <Border Grid.Row="1" Background="#FAFAFA">
            <Grid>
                <!-- æ— æ•°æ®æç¤º -->
                <StackPanel IsVisible="{Binding !HasData}"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Center">
                    <TextBlock Text="ðŸ“­" FontSize="48" HorizontalAlignment="Center"/>
                    <TextBlock Text="æš‚æ— å±žæ€§æ•°æ®" 
                               FontSize="14" 
                               Foreground="#7F8C8D"
                               Margin="0,10,0,0"/>
                    <TextBlock Text="è¯·åœ¨ç»¼åˆæŸ±çŠ¶å›¾ä¸­é€‰æ‹©æ·±åº¦æ®µ" 
                               FontSize="12" 
                               Foreground="#95A5A6"
                               Margin="0,5,0,0"/>
                </StackPanel>
                
                <!-- æ•°æ®æ˜¾ç¤ºåŒºåŸŸ -->
                <Grid IsVisible="{Binding HasData}" 
                      RowDefinitions="Auto,*,Auto">
                    
                    <!-- äº•ä¿¡æ¯å¤´éƒ¨ -->
                    <Border Grid.Row="0" Background="#ECF0F1" Padding="10">
                        <StackPanel Spacing="5">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock Text="ðŸ›¢ï¸" FontSize="14"/>
                                <TextBlock Text="{Binding CurrentWellName}" 
                                           FontSize="14" 
                                           FontWeight="Bold" 
                                           Foreground="#2C3E50"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock Text="ðŸ“" FontSize="12"/>
                                <TextBlock Text="{Binding CurrentDepthRange}" 
                                           FontSize="12" 
                                           Foreground="#7F8C8D"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                    
                    <!-- æ·±åº¦æ®µå±žæ€§åˆ—è¡¨ - å¯ç¼–è¾‘ -->
                    <ScrollViewer Grid.Row="1" Padding="5">
                        <ItemsControl ItemsSource="{Binding DepthProperties}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="White" 
                                            CornerRadius="6" 
                                            Padding="10" 
                                            Margin="5"
                                            BorderBrush="#E0E0E0"
                                            BorderThickness="1">
                                        <StackPanel Spacing="8">
                                            <!-- æ·±åº¦èŒƒå›´æ ‡é¢˜ -->
                                            <Border Background="#3498DB" CornerRadius="4" Padding="8,4">
                                                <Grid ColumnDefinitions="Auto,*,Auto,10,Auto,*,Auto">
                                                    <TextBlock Grid.Column="0" Text="èµ·å§‹:" FontSize="11" Foreground="White" VerticalAlignment="Center"/>
                                                    <TextBox Grid.Column="1" 
                                                             Text="{Binding DepthStart, Mode=TwoWay}" 
                                                             FontSize="11"
                                                             Background="White"
                                                             Padding="4,2"
                                                             MinWidth="50"
                                                             HorizontalAlignment="Stretch"/>
                                                    <TextBlock Grid.Column="2" Text="m" FontSize="11" Foreground="White" VerticalAlignment="Center" Margin="4,0"/>
                                                    <TextBlock Grid.Column="4" Text="ç»ˆæ­¢:" FontSize="11" Foreground="White" VerticalAlignment="Center"/>
                                                    <TextBox Grid.Column="5" 
                                                             Text="{Binding DepthEnd, Mode=TwoWay}" 
                                                             FontSize="11"
                                                             Background="White"
                                                             Padding="4,2"
                                                             MinWidth="50"
                                                             HorizontalAlignment="Stretch"/>
                                                    <TextBlock Grid.Column="6" Text="m" FontSize="11" Foreground="White" VerticalAlignment="Center" Margin="4,0"/>
                                                </Grid>
                                            </Border>
                                            
                                            <!-- å²©æ€§ - ä¸‹æ‹‰é€‰æ‹©+è‡ªå®šä¹‰è¾“å…¥ -->
                                            <Grid ColumnDefinitions="80,*">
                                                <TextBlock Grid.Column="0" 
                                                           Text="å²©æ€§:" 
                                                           FontSize="12" 
                                                           Foreground="#7F8C8D"
                                                           VerticalAlignment="Center"/>
                                                <AutoCompleteBox Grid.Column="1" 
                                                                 Text="{Binding Lithology, Mode=TwoWay}" 
                                                                 ItemsSource="{Binding $parent[UserControl].((vm:PropertyPanelViewModel)DataContext).LithologyOptions}"
                                                                 FilterMode="Contains"
                                                                 FontSize="12"
                                                                 Watermark="é€‰æ‹©æˆ–è¾“å…¥å²©æ€§..."
                                                                 MinHeight="28"/>
                                            </Grid>
                                            
                                            <!-- æ²‰ç§¯ç›¸ - ä¸‹æ‹‰é€‰æ‹©+è‡ªå®šä¹‰è¾“å…¥ -->
                                            <Grid ColumnDefinitions="80,*">
                                                <TextBlock Grid.Column="0" 
                                                           Text="æ²‰ç§¯ç›¸:" 
                                                           FontSize="12" 
                                                           Foreground="#7F8C8D"
                                                           VerticalAlignment="Center"/>
                                                <AutoCompleteBox Grid.Column="1" 
                                                                 Text="{Binding SedimentaryFacies, Mode=TwoWay}" 
                                                                 ItemsSource="{Binding $parent[UserControl].((vm:PropertyPanelViewModel)DataContext).SedimentaryFaciesOptions}"
                                                                 FilterMode="Contains"
                                                                 FontSize="12"
                                                                 Watermark="é€‰æ‹©æˆ–è¾“å…¥æ²‰ç§¯ç›¸..."
                                                                 MinHeight="28"/>
                                            </Grid>
                                            
                                            <!-- åœ°è´¨æè¿° - å¯ç¼–è¾‘æ–‡æœ¬æ¡† -->
                                            <Grid ColumnDefinitions="80,*">
                                                <TextBlock Grid.Column="0" 
                                                           Text="æè¿°:" 
                                                           FontSize="12" 
                                                           Foreground="#7F8C8D"
                                                           VerticalAlignment="Top"
                                                           Margin="0,5,0,0"/>
                                                <TextBox Grid.Column="1" 
                                                         Text="{Binding GeologicalDescription, Mode=TwoWay}" 
                                                         FontSize="11" 
                                                         AcceptsReturn="True"
                                                         TextWrapping="Wrap"
                                                         MinHeight="50"
                                                         MaxHeight="100"/>
                                            </Grid>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    
                    <!-- JSONè§†å›¾åˆ‡æ¢ -->
                    <Expander Grid.Row="2" Header="ðŸ“„ JSON æ•°æ®è§†å›¾" Padding="5">
                        <Border Background="#2C3E50" CornerRadius="4" Padding="10">
                            <ScrollViewer MaxHeight="200" 
                                          HorizontalScrollBarVisibility="Auto">
                                <TextBlock Text="{Binding JsonContent}" 
                                           FontFamily="Consolas, Courier New, monospace"
                                           FontSize="11" 
                                           Foreground="#ECF0F1"
                                           TextWrapping="NoWrap"/>
                            </ScrollViewer>
                        </Border>
                    </Expander>
                </Grid>
            </Grid>
        </Border>
        
        <!-- åº•éƒ¨çŠ¶æ€æ  -->
        <Border Grid.Row="2" Background="#ECF0F1" Padding="8,6">
            <StackPanel Orientation="Horizontal" Spacing="10">
                <TextBlock Text="{Binding PropertyTitle}" 
                           FontSize="11" 
                           Foreground="#7F8C8D"/>
                <TextBlock Text="|" Foreground="#BDC3C7" FontSize="11"/>
                <TextBlock FontSize="11" Foreground="#95A5A6">
                    <TextBlock.Text>
                        <MultiBinding StringFormat="å…± {0} ä¸ªæ·±åº¦æ®µ">
                            <Binding Path="DepthProperties.Count"/>
                        </MultiBinding>
                    </TextBlock.Text>
                </TextBlock>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
