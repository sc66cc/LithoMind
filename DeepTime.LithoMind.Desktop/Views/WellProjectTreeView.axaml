<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:DeepTime.LithoMind.Desktop.ViewModels.Pages"
             x:Class="DeepTime.LithoMind.Desktop.Views.WellProjectTreeView"
             x:DataType="vm:WellProjectTreeViewModel">
    
    <Grid RowDefinitions="Auto,*,Auto">
        <!-- é¡¶éƒ¨å·¥å…·æ  -->
        <Border Grid.Row="0" Background="#2C3E50" Padding="8">
            <Grid ColumnDefinitions="*,Auto,Auto,Auto">
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="ðŸ›¢ï¸" FontSize="16" VerticalAlignment="Center"/>
                    <TextBlock Text="å·¥ç¨‹ç»“æž„ç›®å½•" FontSize="14" Foreground="White" FontWeight="Bold" VerticalAlignment="Center"/>
                </StackPanel>
                <!-- å±•å¼€å…¨éƒ¨æŒ‰é’® -->
                <Button Grid.Column="1" 
                        Content="ðŸ“‚" 
                        ToolTip.Tip="å±•å¼€å…¨éƒ¨"
                        Command="{Binding ExpandAllCommand}"
                        Background="Transparent"
                        BorderThickness="0"
                        Padding="5"
                        Cursor="Hand"/>
                <!-- æŠ˜å å…¨éƒ¨æŒ‰é’® -->
                <Button Grid.Column="2" 
                        Content="ðŸ“" 
                        ToolTip.Tip="æŠ˜å å…¨éƒ¨"
                        Command="{Binding CollapseAllCommand}"
                        Background="Transparent"
                        BorderThickness="0"
                        Padding="5"
                        Cursor="Hand"/>
                <!-- åˆ·æ–°æŒ‰é’® -->
                <Button Grid.Column="3" 
                        Content="ðŸ”„" 
                        ToolTip.Tip="åˆ·æ–°"
                        Command="{Binding RefreshDataCommand}"
                        Background="Transparent"
                        BorderThickness="0"
                        Padding="5"
                        Cursor="Hand"/>
            </Grid>
        </Border>
        
        <!-- æ ‘å½¢ç»“æž„åŒºåŸŸ -->
        <Border Grid.Row="1" Background="#FAFAFA">
            <TreeView x:Name="WellTreeView"
                      ItemsSource="{Binding RootNodes}"
                      SelectedItem="{Binding SelectedNode, Mode=TwoWay}"
                      SelectionMode="Single"
                      Margin="5">
                <TreeView.Styles>
                    <!-- æ ‘èŠ‚ç‚¹æ ·å¼ -->
                    <Style Selector="TreeViewItem" x:DataType="vm:WellDataNode">
                        <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}"/>
                    </Style>
                    <!-- é€‰ä¸­æ¡ç›®æµ…è“è‰²èƒŒæ™¯æ ·å¼ -->
                    <Style Selector="TreeViewItem:selected /template/ Border#PART_LayoutRoot">
                        <Setter Property="Background" Value="#E6F3FF"/>
                    </Style>
                    <Style Selector="TreeViewItem:selected:focus /template/ Border#PART_LayoutRoot">
                        <Setter Property="Background" Value="#CCE8FF"/>
                    </Style>
                </TreeView.Styles>
                
                <TreeView.ItemTemplate>
                    <TreeDataTemplate ItemsSource="{Binding Children}">
                        <StackPanel Orientation="Horizontal" 
                                    Spacing="4" 
                                    Margin="2"
                                    ToolTip.Tip="{Binding Description}">
                            <!-- CheckBox - åªåœ¨ç‰¹å®šç±»åž‹èŠ‚ç‚¹æ˜¾ç¤º -->
                            <CheckBox IsChecked="{Binding IsChecked, Mode=TwoWay}"
                                      IsVisible="{Binding ShowCheckBox}"
                                      VerticalAlignment="Center"
                                      Margin="0,0,2,0"/>
                            <!-- å›¾æ ‡ -->
                            <TextBlock Text="{Binding IconKey}" 
                                       FontSize="14" 
                                       VerticalAlignment="Center"/>
                            <!-- åç§° -->
                            <TextBlock Text="{Binding Name}" 
                                       FontSize="12" 
                                       VerticalAlignment="Center"
                                       Foreground="#2C3E50"/>
                            <!-- æè¿°ï¼ˆä»…éžæ–‡ä»¶å¤¹æ˜¾ç¤ºï¼‰ -->
                            <TextBlock Text="{Binding Description}" 
                                       FontSize="10" 
                                       Foreground="#95A5A6"
                                       VerticalAlignment="Center"
                                       Margin="6,0,0,0"
                                       IsVisible="{Binding Description, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"/>
                        </StackPanel>
                    </TreeDataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>
        </Border>
        
        <!-- åº•éƒ¨çŠ¶æ€æ  -->
        <Border Grid.Row="2" Background="#ECF0F1" Padding="8,6">
            <StackPanel Orientation="Horizontal" Spacing="6">
                <TextBlock Text="ðŸ“¦" FontSize="11" VerticalAlignment="Center" Foreground="#7F8C8D"/>
                <TextBlock Text="{Binding SelectedNode.Name, FallbackValue='é€‰æ‹©èŠ‚ç‚¹æŸ¥çœ‹è¯¦æƒ…'}" 
                           FontSize="11" 
                           Foreground="#2C3E50"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
