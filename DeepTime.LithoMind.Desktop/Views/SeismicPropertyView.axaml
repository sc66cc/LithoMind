<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:DeepTime.LithoMind.Desktop.ViewModels.Pages"
             mc:Ignorable="d" d:DesignWidth="350" d:DesignHeight="600"
             x:Class="DeepTime.LithoMind.Desktop.Views.SeismicPropertyView"
             x:DataType="vm:SeismicPropertyViewModel">

    <UserControl.Styles>
        <!-- å±žæ€§ç»„æ ‡é¢˜æ ·å¼ -->
        <Style Selector="TextBlock.group-title">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#2C3E50"/>
            <Setter Property="Margin" Value="0,12,0,8"/>
        </Style>
        
        <!-- å±žæ€§æ ‡ç­¾æ ·å¼ -->
        <Style Selector="TextBlock.prop-label">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#7F8C8D"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        
        <!-- å±žæ€§å€¼æ ·å¼ -->
        <Style Selector="TextBlock.prop-value">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#2C3E50"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        
        <!-- å±‚ä½å¡ç‰‡æ ·å¼ -->
        <Style Selector="Border.horizon-card">
            <Setter Property="Background" Value="#FFFFFF"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Margin" Value="0,4"/>
            <Setter Property="Padding" Value="12"/>
        </Style>
        
        <Style Selector="Border.horizon-card:pointerover">
            <Setter Property="BorderBrush" Value="#3498DB"/>
            <Setter Property="Background" Value="#F8FBFD"/>
        </Style>
        
        <!-- å¯ç¼–è¾‘æ–‡æœ¬æ¡†æ ·å¼ -->
        <Style Selector="TextBox.editable">
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="#BDC3C7"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Padding" Value="4,2"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>
        
        <Style Selector="TextBox.editable:focus">
            <Setter Property="BorderBrush" Value="#3498DB"/>
        </Style>
        
        <!-- çŠ¶æ€æ ‡ç­¾æ ·å¼ -->
        <Style Selector="Border.status-tag">
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Padding" Value="8,2"/>
        </Style>
    </UserControl.Styles>

    <Border Background="#F5F6FA">
        <DockPanel>
            <!-- é¡¶éƒ¨æ ‡é¢˜æ  -->
            <Border DockPanel.Dock="Top" 
                    Background="#FFFFFF" 
                    BorderBrush="#E0E0E0" 
                    BorderThickness="0,0,0,1"
                    Padding="12,8">
                <DockPanel>
                    <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" Spacing="8">
                        <Button Content="ðŸ”„" 
                                ToolTip.Tip="åˆ·æ–°"
                                Command="{Binding RefreshDataCommand}"
                                Background="Transparent"
                                BorderThickness="0"
                                Padding="6"/>
                    </StackPanel>
                    <StackPanel>
                        <TextBlock Text="{Binding PropertyTitle}" 
                                   FontSize="14" 
                                   FontWeight="SemiBold"
                                   Foreground="#2C3E50"/>
                        <TextBlock Text="{Binding CurrentVolumeName}" 
                                   FontSize="11" 
                                   Foreground="#7F8C8D"
                                   Margin="0,2,0,0"
                                   IsVisible="{Binding HasData}"/>
                    </StackPanel>
                </DockPanel>
            </Border>

            <!-- æ— æ•°æ®æ—¶çš„æç¤º -->
            <StackPanel IsVisible="{Binding !HasData}"
                        VerticalAlignment="Center"
                        HorizontalAlignment="Center"
                        Spacing="12">
                <TextBlock Text="ðŸ“Š" 
                           FontSize="48" 
                           HorizontalAlignment="Center"
                           Opacity="0.5"/>
                <TextBlock Text="è¯·é€‰æ‹©åœ°éœ‡æ•°æ®" 
                           FontSize="14"
                           Foreground="#95A5A6"
                           HorizontalAlignment="Center"/>
            </StackPanel>

            <!-- å±‚ä½åˆ—è¡¨ -->
            <ScrollViewer IsVisible="{Binding HasData}"
                          HorizontalScrollBarVisibility="Disabled"
                          VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="12">
                    <!-- ç»Ÿè®¡æ‘˜è¦ -->
                    <Border Background="#FFFFFF" 
                            CornerRadius="8" 
                            Padding="12"
                            Margin="0,0,0,12">
                        <Grid ColumnDefinitions="*,*,*">
                            <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                <TextBlock Text="{Binding HorizonProperties.Count}" 
                                           FontSize="24" 
                                           FontWeight="Bold"
                                           Foreground="#3498DB"
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="å±‚ä½æ•°é‡" 
                                           FontSize="11" 
                                           Foreground="#7F8C8D"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                <TextBlock Text="3" 
                                           FontSize="24" 
                                           FontWeight="Bold"
                                           Foreground="#27AE60"
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="å·²å®Œæˆ" 
                                           FontSize="11" 
                                           Foreground="#7F8C8D"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                <TextBlock Text="1" 
                                           FontSize="24" 
                                           FontWeight="Bold"
                                           Foreground="#F39C12"
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="è¿›è¡Œä¸­" 
                                           FontSize="11" 
                                           Foreground="#7F8C8D"
                                           HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <TextBlock Classes="group-title" Text="ðŸ“ å±‚ä½åˆ—è¡¨"/>

                    <!-- å±‚ä½å¡ç‰‡åˆ—è¡¨ -->
                    <ItemsControl ItemsSource="{Binding HorizonProperties}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate DataType="{x:Type vm:HorizonPropertyItem}">
                                <Border Classes="horizon-card" 
                                        Cursor="Hand">
                                    <Grid RowDefinitions="Auto,Auto,Auto,Auto,Auto">
                                        <!-- ç¬¬ä¸€è¡Œï¼šåç§°å’ŒçŠ¶æ€ -->
                                        <DockPanel Grid.Row="0">
                                            <!-- å¯è§æ€§å¼€å…³ -->
                                            <CheckBox DockPanel.Dock="Right"
                                                      IsChecked="{Binding IsVisible}"
                                                      ToolTip.Tip="æŽ§åˆ¶æ˜¾ç¤º/éšè—"
                                                      VerticalAlignment="Center"/>
                                            
                                            <!-- é¢œè‰²æŒ‡ç¤ºå™¨ + åç§° -->
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <Border Width="16" Height="16" 
                                                        CornerRadius="4"
                                                        VerticalAlignment="Center">
                                                    <Border.Background>
                                                        <SolidColorBrush Color="{Binding Color}"/>
                                                    </Border.Background>
                                                </Border>
                                                <TextBox Text="{Binding Name, Mode=TwoWay}" 
                                                         Classes="editable"
                                                         FontWeight="SemiBold"
                                                         FontSize="13"/>
                                            </StackPanel>
                                        </DockPanel>

                                        <!-- ç¬¬äºŒè¡Œï¼šçŠ¶æ€æ ‡ç­¾ -->
                                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,8,0,0" Spacing="8">
                                            <Border Classes="status-tag"
                                                    Background="{Binding Status, Converter={x:Static vm:SeismicPropertyViewModel.StatusToColorConverter}}">
                                                <TextBlock Text="{Binding Status}" 
                                                           FontSize="10" 
                                                           Foreground="White"/>
                                            </Border>
                                            <TextBlock Text="{Binding ControlPointCount, StringFormat='æŽ§åˆ¶ç‚¹: {0}'}"
                                                       FontSize="10"
                                                       Foreground="#7F8C8D"
                                                       VerticalAlignment="Center"/>
                                        </StackPanel>

                                        <!-- ç¬¬ä¸‰è¡Œï¼šæ—¶é—´ä¿¡æ¯ -->
                                        <Grid Grid.Row="2" ColumnDefinitions="*,*,*" Margin="0,10,0,0">
                                            <StackPanel Grid.Column="0">
                                                <TextBlock Classes="prop-label" Text="æœ€å°æ—¶é—´"/>
                                                <TextBox Text="{Binding MinTime, Mode=TwoWay, StringFormat={}{0:F0}}" 
                                                         Classes="editable"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Classes="prop-label" Text="å¹³å‡æ—¶é—´"/>
                                                <TextBox Text="{Binding AverageTime, Mode=TwoWay, StringFormat={}{0:F0}}" 
                                                         Classes="editable"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="2">
                                                <TextBlock Classes="prop-label" Text="æœ€å¤§æ—¶é—´"/>
                                                <TextBox Text="{Binding MaxTime, Mode=TwoWay, StringFormat={}{0:F0}}" 
                                                         Classes="editable"/>
                                            </StackPanel>
                                        </Grid>

                                        <!-- ç¬¬å››è¡Œï¼šå¤‡æ³¨ -->
                                        <StackPanel Grid.Row="3" Margin="0,8,0,0">
                                            <TextBlock Classes="prop-label" Text="å¤‡æ³¨"/>
                                            <TextBox Text="{Binding Remarks, Mode=TwoWay}" 
                                                     Classes="editable"
                                                     TextWrapping="Wrap"
                                                     AcceptsReturn="False"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </ScrollViewer>
        </DockPanel>
    </Border>
</UserControl>
